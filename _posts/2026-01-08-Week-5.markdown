---
layout: post
title:  "Week 5"
categories: jekyll update
---

## Lighting

Until now, the lighting data for our scene is the default one (in particular, using a skybox and directional light).
I switched the lighting entirely to the torches placed in the dungeon and regenerated lighting data.
Further, I implemented flickering behaviour for the torches, based on a poisson distribution.

<video width="600" alt="lighting based on torches with flickering effect">
    <source src="{{site.imgpath}}/torches.mp4" type="video/mp4">
</video>

## UI

Added a crosshair and a text element to the UI to show that the player can interact with an object.

## Gameplay

Improved the behaviour of projectiles. Switched hit detection from collisions to raycasting which allows arbitrary projectile speeds.
Further, arrows can now stick to objects (disabling physics, i.e. setting rigidbody to be kinematic) and fall down when that object gets destroyed (i.e. enabling physics).
In particular, arrows now get attached to the animation bones of the opponent, thereby also matching its movements.

With these changes, arrows now stay in the scene and can be picked up after being shot.

<video width="600" alt="arrows sticking to opponent">
    <source src="{{site.imgpath}}/sticking-arrows.mp4" type="video/mp4">
</video>

## Balancing

Added a component to define dungeon properties depending on the level.
These definitions should be used by the dungeon generation algorithm.

By Axel Schneewind

## Assets:

Minor flaws in the mesh of the existing bow and quiver models were fixed.
Textures and materials were then created for these models.

<img width="300" alt="Textured Bow" src="{{site.imgpath}}/textured-bow.png">

<img height="400" alt="Textured Quiver" src="{{site.imgpath}}/textured-quiver.png">

Textures and materials were also created for the new warrior model designed by Guanpu Tian.

<img width="300" alt="Textured Warrior" src="{{site.imgpath}}/textured-warrior.png">

By Rene Tischler

## Dungeon Creation:

During dungeon generation, instantiated assets are no longer placed arbitrary in the scene hierarchy.
The generated level is divided into segments, and the assets are instantiated as children of these segments.
This makes the scene hierarchy much less cluttered.

Furthermore, ceiling meshes are now also generated. Both the floor and the ceiling now use their intended materials.

<img width="300" alt="Current Game View" src="{{site.imgpath}}/floor-ceiling.png">

Torches are also placed as evenly as possible on the walls so that they can illuminate the dungeon in the future.

<img width="300" alt="Placed Torches" src="{{site.imgpath}}/placed-torches.png">

By Rene Tischler

## Awkward Corridor Fix

<img width="300" alt="Awkward Corridor Example" src="{{site.imgpath}}/akward_corridor.png">

During the dungeon creation the calculations of the corridors could end in "awkward" corridors, how we call them.
The Problem can be seen in the reference picture. The Algorithm could choose the left room to connect to the bottom room.
But since the connecting space between the rooms is insufficent a barley or not even passable corridor is placed.
To fix this error, the corner of all possible rooms for connecting two partions are checked. For example in the reference picture the 
length of the left bottom corner of the top room to the right top corner of the bottom room and vice versa. Dividing now the smaller length by
the lager length gives a proportion from 0 to 1, on how much the rooms overlap with eachother. With 1 meaning they overlap 100% and
0 meaning they dont overlap at all. Now the Algorthim searches for the largest proportion and with that the probleme of akward corridors is fixed.

By Sven Gerber

## Game Saving

A minor bug that prevented the game save file from loading correctly has been fixed in the game save system developed by David.

By Rene Tischler

## More Models 
We have new improved sword model, for player and enemies.

![]({{site.imgpath}}/sword.png){: height="250ex"}

and some foliage sounds for the sword.

...and i began working on the door for the boss room.
![The images shows a 3dmodel of a two part door that has a big skull as decoration on it. You can als see some rigging for it]({{site.imgpath}}/boss-door-1.png){:height="300ex"}

I am currently working on the animation for the door. Next steps are materials foliage for it.

Also some blog documentation and bug minor bug fixes. etc. 

By David Ruff

## Combat System & Enemy Behavior

The player now uses the new first person warrior model. The model is animated using its own animation controller that supports movement in all four directions, an idle animation, a jump animation and an attack animation. The movement animations are sped up when the player is sprinting. The attack animation is on another layer so that it can play in parallel with the movement animations.

By Moritz Mahling
